<html>
	<body>
		<style>
			canvas {
				position: absolute;
				top: 0px;
				left: 0px;
				background: transparent;
			}
			.scoreT_value_display
			{
				color: gold;
			}
		</style>
		<canvas id="bg" style="z-index: -99;"></canvas>
		<canvas id="canvas" style="z-index: 100;">Your browser does not support canvas. Please try again with a different browser.</canvas>
		
		<script src="jquery.min.js"></script>
		
		<script>
			function time()
			{
				return Math.round(+new Date()/1000);
			}
			
			function secondsToHms(d) {
				d = Number(d);
				var h = Math.floor(d / 3600);
				var m = Math.floor(d % 3600 / 60);
				var s = Math.floor(d % 3600 % 60);

				//var hDisplay = h > 0 ? h + (h == 1 ? " hour, " : " hours, ") : "";
				//var mDisplay = m > 0 ? m + (m == 1 ? " minute, " : " minutes, ") : "";
				//var sDisplay = s > 0 ? s + (s == 1 ? " second" : " seconds") : "";
				var hDisplay = h > 0 ? h + (h == 1 ? ":" : ":") : "";
				var mDisplay = m > 0 ? m + (m == 1 ? ":" : ":") : "";
				var sDisplay = s > 0 ? s + (s == 1 ? "" : "") : "";
		
				
				return hDisplay + mDisplay + sDisplay; 
			}
		
			window.onload = Construct();
			var c;
			var ctx;
			var mouse = {
				x: 0,
				y: 0
			};
			var lastStep = 0;
			var particles = [{
					x: 0,
					y: 0
				}];

			var playTime = 0;
			var playerAddScore = 0;
			var playerTotalScore = 0;
			
			
    
			var timerT = null;
			var timerT = null;
			timerT = document.createElement('span');
			timerT.className = 'timerT';
			document.body.appendChild(timerT);
			timerTPositionTop = 15;
			timerTPositionLeft = window.innerWidth/2 - 20;
			$(".timerT").css({top: timerTPositionTop, left: timerTPositionLeft, position:'absolute'})
    
    
    		
			var scoreT = null;
			var scoreT = null;
			scoreT = document.createElement('span');
			scoreT.className = 'scoreT';
			document.body.appendChild(scoreT);
			scoreTPosition = window.innerWidth - 100;
			$(".scoreT").css({top: 15, left: scoreTPosition, position:'absolute'})
			$(".scoreT").append("Score: <strong><span class='scoreT_value_display'>0</span></strong>")

			var coordinatesT = null;
			coordinatesT = document.createElement('span');
			coordinatesT.className = 'coordinatesT';
			document.body.appendChild(coordinatesT);
			$(".coordinatesT").css({top: 15, left: 15, position:'absolute'})
    
    
			var planeX = 0;
			var planeX2 = 0;
			var planeY = 0;
			var planeY2 = 0;
        
			coordinatesT.value = planeX + " , " + planeY;

			window.setInterval(function(){
					playTime++;
					playerTotalScore = playTime + playerAddScore;
					timerT.value = playTime;
					scoreT.value = playerTotalScore;
					
					timerT.innerHTML = "Time: " + secondsToHms(playTime);
					$('.scoreT_value_display').html(playerTotalScore);
				}, 1000);

			function Construct() {
				setTimeout(function () {
						c = document.getElementById("canvas");
						ctx = c.getContext("2d");
						c.addEventListener('mousemove', function (e) {
								var m = getMousePos(c, e);
								mouse.x = m.x;
								mouse.y = m.y;
							}, false);
						window.requestAnimationFrame(animationFrame);
					}, 1);
			}

			function animationFrame(milliseconds) {
				var elapsed = milliseconds - lastStep;
				lastStep = milliseconds;

				render(elapsed);

				window.requestAnimationFrame(animationFrame);
			}


			function  getMousePos(canvas, evt) {
				var rect = canvas.getBoundingClientRect(), // abs. size of element
				scaleX = canvas.width / rect.width,    // relationship bitmap vs. element for X
				scaleY = canvas.height / rect.height;  // relationship bitmap vs. element for Y

				return {
					x: (evt.clientX - rect.left) * scaleX,   // scale mouse coordinates after they have
					y: (evt.clientY - rect.top) * scaleY     // been adjusted to be relative to element
				}
			}

			function render(elapsed) {
				setCanvasSize(ctx);
				clearCanvas(ctx);
				moveParticles(elapsed);
				renderParticles();
			}

			function setCanvasSize(canvasContext) {
				canvasContext.canvas.width = window.innerWidth;
				canvasContext.canvas.height = window.innerHeight;
			}

			function clearCanvas(canvasContext) {
				canvasContext.globalCompositeOperation = "source-over";
				canvasContext.fillStyle = "rgba(255, 255, 255, 0)";
				canvasContext.fillRect(0, 0, canvas.width, canvas.height);
			}

			function moveParticles(milliseconds) {
				particles.forEach(function (p) {
						var data = distanceAndAngleBetweenTwoPoints(p.x, p.y, mouse.x, mouse.y);
						var velocity = data.distance / 0.5;
						var toMouseVector = new Vector(velocity, data.angle);
						var elapsedSeconds = milliseconds / 1000;

						p.x += (toMouseVector.magnitudeX * elapsedSeconds);
						p.y += (toMouseVector.magnitudeY * elapsedSeconds);
					});
			}


			function renderParticles() {
				particles.forEach(function (p) {
						var img = document.getElementById("plane");
						ctx.drawImage(img, p.x - (img.width/2), p.y - (img.height/2));
						//alert(p.x + " , " + p.y);
						planeX = p.x.toFixed(0);
						planeX2 = planeX + img.width;
						planeY = p.y.toFixed(0);
						planeY2 = planeY + img.height;

						coordinatesT.innerHTML = planeX + "," + planeY;
					});
			}


			function renderParticlesOld() {
				particles.forEach(function (p) {
						ctx.save();
						ctx.beginPath();
						ctx.translate(p.x, p.y);
						ctx.arc(0, 0, 10, 0, 2 * Math.PI);
						ctx.fillStyle = "blue";
						ctx.fill();
						ctx.stroke();
						ctx.restore();
					});
			}

			function distanceAndAngleBetweenTwoPoints(x1, y1, x2, y2) {
				var x = x2 - x1,
				y = y2 - y1;

				return {
					// x^2 + y^2 = r^2
					distance: Math.sqrt(x * x + y * y),

					// convert from radians to degrees
					angle: Math.atan2(y, x) * 180 / Math.PI
				}
			}

			function Vector(magnitude, angle) {
				var angleRadians = (angle * Math.PI) / 180;

				this.magnitudeX = magnitude * Math.cos(angleRadians);
				this.magnitudeY = magnitude * Math.sin(angleRadians);
			}
		</script>
		<script src="backgroundScrolling.js"></script>
		<img id="plane" style="display: none;" src="plane.png">
	</body>
</html>